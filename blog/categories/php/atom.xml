<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: php | Random thoughts | Hari KT]]></title>
  <link href="http://harikt.com/blog/categories/php/atom.xml" rel="self"/>
  <link href="http://harikt.com/"/>
  <updated>2013-11-01T07:16:30+05:30</updated>
  <id>http://harikt.com/</id>
  <author>
    <name><![CDATA[Hari K T]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Looking at aura version 2]]></title>
    <link href="http://harikt.com/blog/2013/09/28/looking-at-aura-v2/"/>
    <updated>2013-09-28T06:53:00+05:30</updated>
    <id>http://harikt.com/blog/2013/09/28/looking-at-aura-v2</id>
    <content type="html"><![CDATA[<p>If you have noticed recently, there have been tons of commits from
<a href="https://github.com/pmjones">Paul M Jones</a>﻿ for aura version 2.</p>

<p>More standalone repos born. Everyone should try and give feedback as much as possible.</p>

<p>Interesting stuffs split from Aura.Sql v 1.3 are</p>

<p><a href="https://github.com/auraphp/Aura.Sql/tree/develop-2">Extended PDO</a>,</p>

<p>As the name says, it is an extended version of PDO. Good thing is it is
PHP 5.3 compatible.</p>

<p>If you have worked with PDO you know the good and bad.
One of the difficulty is, it cannot use an array for an in clause.</p>

<p>```php
&lt;?php
// the array to be quoted
$array = array(&lsquo;foo&rsquo;, &lsquo;bar&rsquo;, &lsquo;baz&rsquo;);</p>

<p>// the statement to prepare
$stm = &lsquo;SELECT * FROM test WHERE foo IN (:foo) AND bar = :bar&rsquo;</p>

<p>// the native PDO way does not work (PHP Notice:  Array to string conversion)
$pdo = new Pdo(&hellip;);
$sth = $pdo->prepare($stm);
$sth->bindValue(&lsquo;foo&rsquo;, $array);
```</p>

<p>ExtendedPDO helps you to do it.</p>

<p>```php
&lt;?php
$pdo = new ExtendedPdo(&hellip;);
$stm = &lsquo;SELECT * FROM test WHERE foo IN (:foo)&rsquo;;
$pdo->bindValues(array(</p>

<pre><code>'foo' =&gt; array('foo', 'bar', 'baz'),
'bar' =&gt; 'qux',
</code></pre>

<p>));
$sth = $pdo->prepare($stm);
echo $sth->queryString;
```</p>

<p>Try out an example, and see in action.</p>

<p>Your composer.json will look as</p>

<p>```json
{</p>

<pre><code>"minimum-stability": "dev",
"require": {
    "aura/sql":"dev-develop-2"
}
</code></pre>

<p>}
```</p>

<p>Run the below Sql query in your favourite tools like phpmyadmin or adminer.</p>

<p>```sql
&mdash; Adminer 3.7.1 MySQL dump</p>

<p>SET NAMES utf8;
SET foreign_key_checks = 0;
SET time_zone = &lsquo;+05:30&rsquo;;
SET sql_mode = &lsquo;NO_AUTO_VALUE_ON_ZERO&rsquo;;</p>

<p>DROP TABLE IF EXISTS <code>polls_choice</code>;
CREATE TABLE <code>polls_choice</code> (
  <code>id</code> int(11) NOT NULL AUTO_INCREMENT,
  <code>poll_id</code> int(11) NOT NULL,
  <code>choice_text</code> varchar(200) NOT NULL,
  <code>votes</code> int(11) NOT NULL,
  PRIMARY KEY (<code>id</code>)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;</p>

<p>INSERT INTO <code>polls_choice</code> (<code>id</code>, <code>poll_id</code>, <code>choice_text</code>, <code>votes</code>) VALUES
(1, 1,  &lsquo;Not much&rsquo;, 0),
(2, 1,  &lsquo;The sky&rsquo;,  0),
(5, 1,  &lsquo;Hello World&rsquo;,  0);</p>

<p>&mdash; 2013-09-28 11:22:17
```</p>

<p>Run the below PHP code and see the result.</p>

<p>```php
&lt;?php
require <strong>DIR</strong> . &lsquo;/vendor/autoload.php&rsquo;;</p>

<p>use Aura\Sql\ExtendedPdo;
use Aura\Sql\Profiler;</p>

<p>$pdo = new ExtendedPdo(</p>

<pre><code>'mysql:host=localhost;dbname=dbname',
'user',
'password',
array(), // driver options as key-value pairs
array()  // attributes as key-value pairs
</code></pre>

<p>);
$pdo->setProfiler(new Profiler);
$pdo->getProfiler()&ndash;>setActive(true);</p>

<p>$stm = &lsquo;SELECT * FROM polls_choice WHERE id IN (:id) AND poll_id = :poll_id&rsquo;;</p>

<p>$bind = array(</p>

<pre><code>'id' =&gt; array('1', '2'),
'poll_id' =&gt; '1',
</code></pre>

<p>);
$results = $pdo->fetchAll($stm, $bind);</p>

<p>foreach ($results as $result) {
  echo &ldquo;Query Result : &rdquo; . $result[&lsquo;choice_text&rsquo;] . PHP_EOL;
}</p>

<p>echo &ldquo;Profiler&rdquo; . PHP_EOL;</p>

<p>$profiles = $pdo->getProfiler()&ndash;>getProfiles();</p>

<p>foreach ($profiles as $profile) {
  echo &lsquo; Function : &rsquo; . $profile[&lsquo;function&rsquo;] . PHP_EOL;
  echo &lsquo; Duration : &rsquo; . $profile[&lsquo;duration&rsquo;] . PHP_EOL;
  echo &lsquo; Statement : &rsquo; . $profile[&lsquo;statement&rsquo;] . PHP_EOL;
  echo &lsquo; Bind Values : &rsquo; . print_r($profile[&lsquo;bind_values&rsquo;], true) . PHP_EOL;
}
```</p>

<p>It comes with lazy connection, profiler, connection locator etc. Read more from
<a href="https://github.com/auraphp/Aura.Sql/tree/develop-2#getting-started">getting started docs</a></p>

<h2><a href="https://github.com/auraphp/Aura.Sql_Schema">Aura.Sql_Schema</a></h2>

<p>An independent schema discovery tool for MySQL, PostgreSQL,
SQLite, and Microsoft SQL Server. You can
<a href="https://github.com/auraphp/Aura.Sql_Schema#getting-started">read more from the docs</a></p>

<h2><a href="https://github.com/auraphp/Aura.Sql_Query">Aura.Sql_Query</a></h2>

<p>Independent query builders for MySQL, PostgreSQL, SQLite, and Microsoft SQL Server</p>

<p>Good thing is all are standalone.</p>

<p>Version 2 also comes with a new
<a href="https://github.com/auraphp/Aura.Dispatcher">Dispatcher</a>
and <a href="https://github.com/auraphp/Aura.Includer">Includer</a>.</p>

<p>You can read the story behind Dispatcher from
<a href="https://groups.google.com/d/msg/auraphp/hyjEPEeo6_w/u616Pu3kQrcJ">here</a>
and Includer from
<a href="https://groups.google.com/d/msg/auraphp/WOo6TSceqHU/ZdgIkUgU0VIJ">here</a></p>

<p>vi <a href="https://github.com/auraphp/Aura.Includer">Includer</a>
aura solved one of the problem of reading configuration files.</p>

<p>Let us look into the example of the Aura.Includer and how it works.</p>

<p>The <code>composer.json</code> looks like the one below.</p>

<p>```json
{</p>

<pre><code>"minimum-stability": "dev",
"require": {
    "aura/cli": "dev-develop-2",
    "aura/web": "dev-develop-2",
    "aura/autoload": "dev-develop-2",
    "aura/dispatcher": "dev-develop-2",
    "aura/html": "dev-master",
    "aura/input": "dev-master",
    "aura/view": "2.*",
    "aura/includer": "dev-develop-2",
    "aura/router": "dev-develop",
    "aura/di": "1.*"
}
</code></pre>

<p>}
```</p>

<p>We can use the includer to read the configuration files and store it and
later use the cached file. The <code>includer.php</code> looks like</p>

<p>```php
&lt;?php
$loader = require <strong>DIR</strong> . &lsquo;/vendor/autoload.php&rsquo;;</p>

<p>$includer = new \Aura\Includer\Includer();</p>

<p>$includer->setDirs(array(</p>

<pre><code>__DIR__ . '/vendor/aura/router',
__DIR__ . '/vendor/aura/dispatcher',
__DIR__ . '/vendor/aura/web',
__DIR__ . '/vendor/aura/view',
__DIR__ . '/vendor/aura/html',
__DIR__ . '/vendor/aura/cli',
__DIR__ . '/vendor/aura/input',
</code></pre>

<p>));</p>

<p>$includer->setFiles(array(</p>

<pre><code>'config/default.php',
</code></pre>

<p>));</p>

<p>use Aura\Router\Map;
use Aura\Router\DefinitionFactory;
use Aura\Router\RouteFactory;</p>

<p>$router = new Map(new DefinitionFactory, new RouteFactory);</p>

<p>use Aura\Di\Container;
use Aura\Di\Forge;
use Aura\Di\Config;</p>

<p>$di = new Container(new Forge(new Config));</p>

<p>$includer->setVars(array(</p>

<pre><code>'loader' =&gt; $loader,
'router' =&gt; $router,
'di' =&gt; $di,
</code></pre>

<p>));</p>

<p>if (! file_exists(<strong>DIR</strong> . &lsquo;/cache/includer.php&rsquo;)) {</p>

<pre><code>$includer-&gt;load();
$text = $includer-&gt;read();
file_put_contents(__DIR__ . '/cache/includer.php', '&lt;?php' . PHP_EOL . $text);
</code></pre>

<p>} else {</p>

<pre><code>$includer-&gt;setCacheFile(__DIR__ . '/cache/includer.php');
$includer-&gt;load();
</code></pre>

<p>}
$stdio = $di->newInstance(&lsquo;Aura\Cli\Stdio&rsquo;);
$stdio->outln(&lsquo;This is normal text.&rsquo;);
```</p>

<p>Install the dependencies via <code>composer</code> and run via cli <code>php includer.php</code>.</p>

<p>The Aura.Includer is a nice addition for version 2
( I am also seeing it can be used in version 1 )
which will help a lot in the making of the framework with the libraries.</p>

<p>If you are interested to use, learn, or have a feedback a warm welcome to
<a href="https://groups.google.com/forum/#!forum/auraphp">join the google group for aura project for PHP</a></p>

<p>Have a nice day ahead. Enjoy PHPing.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Chance to Win Free Copies of Packt’s new book on Zend Framework 2.0]]></title>
    <link href="http://harikt.com/blog/2013/08/23/chance-to-win-free-copies-of-packts-new-book-on-zend-framework-2-dot-0/"/>
    <updated>2013-08-23T11:59:00+05:30</updated>
    <id>http://harikt.com/blog/2013/08/23/chance-to-win-free-copies-of-packts-new-book-on-zend-framework-2-dot-0</id>
    <content type="html"><![CDATA[<p>I have teamed up with <a href="http://www.packtpub.com">Packt Publishing</a> to organize a contest
of its newly published book on
<a href="http://www.packtpub.com/zend-framework-2-0-by-example-beginners-guide/book">Zend Framework 2.0 by example</a></p>

<p>And 3 lucky winners stand a chance to win eBook copies of the book.
Keep reading to find out how you can be one of the Lucky Winners.</p>

<h2>Overview of the book</h2>

<ul>
<li><p> Master application development with Zend Framework 2.0</p></li>
<li><p> Learn about Zend Framework components and use them for functions such as searching, image
processing, and payment gateway integrations</p></li>
<li><p> Integrate third-party services for media sharing and payment processing</p></li>
</ul>


<h2>How to Enter ?</h2>

<p>All you need to do is head on over to the
<a href="http://www.packtpub.com/zend-framework-2-0-by-example-beginners-guide/book">book page</a>
and look through the product description of the book and drop a line via the
comments below this post to let us know what interests you the most about this book.
It’s that simple.</p>

<p>Deadline:The contest will close in 1 weeks time (ie 30th August 2013).
Winners will be contacted by email, so be sure to use your real email
address when you comment! Hurry up as you could be one of the few lucky
ones to get yourself a free ebook of the latest released title.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Connecting to Magento via SOAP]]></title>
    <link href="http://harikt.com/blog/2013/07/12/connecting-to-magento-via-soap/"/>
    <updated>2013-07-12T14:12:00+05:30</updated>
    <id>http://harikt.com/blog/2013/07/12/connecting-to-magento-via-soap</id>
    <content type="html"><![CDATA[<p>In my earlier post I have shown how you can connect to Magento
with REST api. In this post let us connect via SOAP.</p>

<p>The below class acts like a proxy to call the magento soap api.</p>

<p>```php
&lt;?php
/<em>*
 *
 * @author Hari K T
 *
 </em>/
class My_Soap_Magento
{</p>

<pre><code>/**
 * 
 * Host name to connect
 * 
 * @var string
 * 
 */
protected $hostname;

/**
 * 
 * User name
 * 
 * @var string
 * 
 */
protected $username;

/**
 * 
 * API Key
 * 
 * @var string
 * 
 */
protected $apikey;

/**
 * 
 * Zend_Soap_Client
 * 
 * @var Zend_Soap_Client
 * 
 */
protected $client;


protected $session;

/**
 * 
 * Constructor
 * 
 * @param string $hostname The host name
 * 
 * @param string $username The user name of the host
 * 
 * @param string $apikey The apikey of the host
 * 
 */
public function __construct($hostname, $username, $apikey)
{        
    $this-&gt;hostname = $hostname;
    $this-&gt;username = $username;
    $this-&gt;apikey   = $apikey;        
}

/**
 * 
 * Magic method, the methods are named on the basis of Magento SOAP api
 * You don't need to pass the session as the first argument, for convience.
 * 
 * @link http://www.magentocommerce.com/api/soap/introduction.html
 * 
 * @param string $function
 * 
 * @param mixed $args
 * 
 * @return string | null
 * 
 */
public function __call($function, $args)
{
    $session = $this-&gt;getSession();
    $params = array_merge(array($this-&gt;getSession()), $args);
    $result = call_user_func_array(array($this-&gt;getClient(), $function), $params);
    if ($result) {
        // I need to get as json
        return Zend_Json_Encoder::encode($result);
    }
    return null;
}        

/**
 * 
 * Get the session from logging in to the Magento server
 * 
 * @return string
 * 
 */
public function getSession()
{
    if (! $this-&gt;session) {
        try {
            $this-&gt;session = $this-&gt;getClient()-&gt;login($this-&gt;username, $this-&gt;apikey);
        } catch (Exception $e) {

        }
    }
    return $this-&gt;session; 
}

/**
 * 
 * If we already have a session, we can set the session so it don't 
 * need to login again and get the session. This helps to reduce the 
 * call for login . 
 * 
 * @see getSession()
 * 
 * @param string $session
 * 
 * @return IM_Soap_Magento
 * 
 */
public function setSession($session)
{
    $this-&gt;session = $session;
    return $this;
}

/**
 * 
 * Get the Zend_Soap_Client object
 * 
 * @return Zend_Soap_Client
 * 
 */
public function getClient()
{
    if (! $this-&gt;client) {
        $endpoint  = trim($this-&gt;hostname, '/') . '/api/v2_soap/?wsdl';
        $this-&gt;client = new Zend_Soap_Client(            
            $endpoint
        );
    }     
    return $this-&gt;client;   
}
</code></pre>

<p>}
```</p>

<p>In order to connect you want to create an object of the above
class <code>My_Soap_Magento</code>. You need to get the username and api key
from the magento host.</p>

<p>```php
$object = new My_Soap_Magento(</p>

<pre><code>'the-magento-host',
'username',
'apikey'
</code></pre>

<p>);
```</p>

<p>Now you are done! You can connect to the soap api version 2 of
Magento server.</p>

<p>Sample how to get the product information, category tree,
category information, products list etc are shown below.</p>

<p>See we are not passing the session parameter.</p>

<p>```php
echo &ldquo;Product Info&rdquo;;
$result = $proxy->catalogProductInfo(16);
echo $result;</p>

<p>echo &ldquo;Category Tree&rdquo;;
$result = $proxy->catalogCategoryTree();
echo $result;</p>

<p>echo &ldquo;Category Info&rdquo;;
$result = $proxy->catalogCategoryInfo(10);
echo $result;</p>

<p>echo &lsquo;Products List&rsquo;;
$result = $proxy->catalogProductList();
echo $result;
```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The book on aura]]></title>
    <link href="http://harikt.com/blog/2013/07/09/the-book-on-aura/"/>
    <updated>2013-07-09T06:55:00+05:30</updated>
    <id>http://harikt.com/blog/2013/07/09/the-book-on-aura</id>
    <content type="html"><![CDATA[<p>There has been lot of requests to show how the individual packages
in aura, can be made use inside the framework.</p>

<p>So today I am happy to announce that there is a work in progress
to make the framework documentation better. I have already started
the work on the same.</p>

<p>You can <a href="http://auraphp.com/manuals/">read the chapters online</a>.</p>

<p>The examples used in the book are also online at<br/>
<a href="https://github.com/harikt/Example.Package">https://github.com/harikt/Example.Package</a></p>

<blockquote><p>I hope Something is better than nothing.</p></blockquote>

<h2>Question / Doubts</h2>

<p>Ask your question / doubts in
<a href="https://groups.google.com/forum/#!forum/auraphp">google groups</a></p>

<h2>Feedback</h2>

<p>I will be more happy to hear your feedback, critics, comments etc.
So do shout at me.</p>

<h2>Contributing</h2>

<p>If you interested in contributing to make it better, it is available
at <a href="https://github.com/auraphp/auraphp.github.com">https://github.com/auraphp/auraphp.github.com</a></p>

<p>Written in markdown. Still have hard time understanding things, create
an issue mentioning the problems you are facing.</p>

<h2>Thanks</h2>

<p>I would like to thank Paul M Jones for the awesome work he has done
on aura.</p>

<p>A special Thanks to <a href="https://github.com/jsurgeson">Jeff Surgeson</a> for
continously asking for the book.</p>

<p>Last but not the least, all who have motivated me to write a book.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Aura turns 2]]></title>
    <link href="http://harikt.com/blog/2013/02/22/aura-turns-2/"/>
    <updated>2013-02-22T23:07:00+05:30</updated>
    <id>http://harikt.com/blog/2013/02/22/aura-turns-2</id>
    <content type="html"><![CDATA[<p>Looking over <a href="https://github.com/auraphp/Aura.Router/commit/8de403dc49bf803a1fd641f55726079853716ab7">the commits on Aura.Router</a>, <a href="https://github.com/auraphp/Aura.Signal">Aura.Signal</a> etc you will
notice, <a href="https://github.com/auraphp">aura project</a> has turned 2.</p>

<p>And today, I would like to introduce you, the new born baby still under active
development and refactoring based on user feedback, the
<a href="https://github.com/auraphp/Aura.Input">form library for php, Aura.Input</a>.</p>

<p>The <a href="https://github.com/auraphp/Aura.Input">Aura.Input</a>, doesn&rsquo;t have a rendering functionality. But you can always
use Aura.View or create your own helpers.</p>

<p>A basic filtering based on closure exists in <a href="https://github.com/auraphp/Aura.Input">Aura.Input</a>. But you are
not limited, you can use your own filtering components or
integrate <a href="https://github.com/auraphp/Aura.Filter">Aura.Filter</a>.</p>

<p>Let us look at some code.</p>

<p>```php
&lt;?php
// use composer or require &lsquo;/path/to/Aura.Input/src.php&rsquo;;</p>

<p>use Aura\Input\Form;
use Aura\Input\Builder;
use Aura\Input\Filter;</p>

<p>$filter = new Aura\Input\Filter();</p>

<p>// validate
$filter->setRule(&lsquo;name&rsquo;, &lsquo;Name should be alpha only&rsquo;, function ($value) {</p>

<pre><code>return ctype_alpha($value);
</code></pre>

<p>});</p>

<p>$filter->setRule(&lsquo;email&rsquo;, &lsquo;Enter a valid email address&rsquo;, function ($value) {</p>

<pre><code>return filter_var($value, FILTER_VALIDATE_EMAIL);
</code></pre>

<p>});</p>

<p>$filter->setRule(&lsquo;url&rsquo;, &lsquo;Enter a valid url&rsquo;, function ($value) {</p>

<pre><code>return filter_var($value, FILTER_VALIDATE_URL);
</code></pre>

<p>});</p>

<p>$filter->setRule(&lsquo;message&rsquo;, &lsquo;Message should be more than 7 characters&rsquo;, function ($value) {</p>

<pre><code>if (strlen($value) &gt; 7) {
    return true;
}
return false;
</code></pre>

<p>});</p>

<p>class ContactForm extends Form
{</p>

<pre><code>public function init()
{
    $name    = $this-&gt;setField('name');
    $email   = $this-&gt;setField('email');
    $url     = $this-&gt;setField('url');
    $message = $this-&gt;setField('message', 'textarea');
}
</code></pre>

<p>}</p>

<p>$form = new ContactForm(new Builder, $filter);</p>

<p>$values = [</p>

<pre><code>'name' =&gt; 'Hari K T',
'email' =&gt; 'oh will it works!',
'url' =&gt; 'google.com',
'message' =&gt; 'Aweso'
</code></pre>

<p>];</p>

<p>$form->setValues($values);</p>

<p>$passed = $form->filter();</p>

<p>// &lsquo;foo&rsquo; is invalid
if (! $passed) {</p>

<pre><code>// get all messages
$actual = $form-&gt;getMessages();
var_dump($actual);
</code></pre>

<p>}
```</p>

<p>Try it out, we have some more documentation for the <a href="https://github.com/auraphp/Aura.Input">Aura.Input</a>. I warn
the api is still not stable for <a href="https://github.com/auraphp/Aura.Input">Aura.Input</a> and is not yet released a Beta.</p>

<p>But it is a good start!</p>
]]></content>
  </entry>
  
</feed>
