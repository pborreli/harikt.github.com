<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Validation | Random thoughts | Hari KT]]></title>
  <link href="http://harikt.com/blog/categories/validation/atom.xml" rel="self"/>
  <link href="http://harikt.com/"/>
  <updated>2014-04-03T10:19:01+05:30</updated>
  <id>http://harikt.com/</id>
  <author>
    <name><![CDATA[Hari K T]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Standalone Form for PHP]]></title>
    <link href="http://harikt.com/blog/2013/05/23/standalone-form-for-php/"/>
    <updated>2013-05-23T07:03:00+05:30</updated>
    <id>http://harikt.com/blog/2013/05/23/standalone-form-for-php</id>
    <content type="html"><![CDATA[<p>Yesterday I wrote about <a href="http://harikt.com/blog/2013/05/21/standalone-forms-and-validation/">Standalone Forms and Validation</a>. It may need
a little bit knowledge on how the <a href="http://auraphp.com/packages">Aura.Filter</a> works. But that is
a good start if you want to know how you can integrate the pieces of Aura.</p>

<p>Today I think I need to show you the very minimal approach you can take
to build the form and validate your form. If you want to
use a powerful validation and filtering use something like <a href="http://auraphp.com/packages">Aura.Filter</a>
or bind your favourite components which does the validation <a href="https://github.com/Respect/Validation">Respect</a>, <a href="https://github.com/symfony/validator">Symfony2 Validator</a>,
<a href="https://github.com/vlucas/valitron">valitron</a> and filtering with something like <a href="https://github.com/rdohms/DMS-Filter">DMS-Filter</a>.</p>

<p>You can see how you can integrate with different components as I did with
<a href="http://auraphp.com/packages">Aura.Filter</a> in the example in master branch.</p>

<p>I assume you know a bit about <a href="http://getcomposer.org">composer</a> and how to install.</p>

<p>The <code>composer.json</code> file</p>

<p>```php
{</p>

<pre><code>"minimum-stability": "dev",
"require": {
    "aura/input": "1.0.0-beta1",
    "aura/view": "1.1.2"
}
</code></pre>

<p>}
```</p>

<p>The page which you need to bring the form.</p>

<p>```php
&lt;?php</p>

<p>use Aura\Input\Builder;
use Aura\Input\Filter;
use Aura\Input\Form;</p>

<p>$loader = require <strong>DIR</strong> . &lsquo;/vendor/autoload.php&rsquo;;</p>

<p>class ContactForm extends Form
{</p>

<pre><code>public function init()
{
    $this-&gt;setField('name')
        -&gt;setAttribs([
            'id' =&gt; 'name',
            'size' =&gt; 20,
            'maxlength' =&gt; 20,
        ]);
    $this-&gt;setField('email')
        -&gt;setAttribs([
            'size' =&gt; 20,
            'maxlength' =&gt; 20,
        ]);
    $this-&gt;setField('url')
        -&gt;setAttribs([
            'size' =&gt; 20,
            'maxlength' =&gt; 20,
        ]);
    $this-&gt;setField('message', 'textarea')
        -&gt;setAttribs([
            'cols' =&gt; 40,
            'rows' =&gt; 5,
        ]);
    $this-&gt;setField('submit', 'submit')
        -&gt;setAttribs(['value' =&gt; 'send']);

    $filter = $this-&gt;getFilter();

    $filter-&gt;setRule(
        'name',
        'Name must be alphabetic only.',
        function ($value) {
            return ctype_alpha($value);
        }
    );

    $filter-&gt;setRule('email', 'Enter a valid email address', function ($value) {
        return filter_var($value, FILTER_VALIDATE_EMAIL);
    });

    $filter-&gt;setRule('url', 'Enter a valid url', function ($value) {
        return filter_var($value, FILTER_VALIDATE_URL);
    });

    $filter-&gt;setRule('message', 'Message should be more than 7 characters', function ($value) {
        if (strlen($value) &gt; 7) {
            return true;
        }
        return false;
    });
}
</code></pre>

<p>}</p>

<p>$form = new ContactForm(new Builder(), new Filter());</p>

<p>if ($<em>POST &amp;&amp; $</em>POST[&lsquo;submit&rsquo;] == &lsquo;send&rsquo;) {</p>

<pre><code>$data = $_POST;
$form-&gt;fill($data);
if ($form-&gt;filter()) {
    //
    echo "Yes successfully validated and filtered";
    var_dump($data);
    exit;
}
</code></pre>

<p>}</p>

<p>$helper = new Aura\View\HelperLocator([</p>

<pre><code>'field'         =&gt; function () { 
    return new Aura\View\Helper\Form\Field(
        require dirname(__DIR__) . '/vendor/aura/view/scripts/field_registry.php'
    ); 
},
'input'         =&gt; function () { return new Aura\View\Helper\Form\Input(
        require dirname(__DIR__) . '/vendor/aura/view/scripts/input_registry.php'
    ); 
},
'radios'        =&gt; function () { return new Aura\View\Helper\Form\Radios(new Aura\View\Helper\Form\Input\Checked); },
'repeat'         =&gt; function () { return new Aura\View\Helper\Form\Repeat(
        require dirname(__DIR__) . '/vendor/aura/view/scripts/repeat_registry.php'
    ); 
},
'select'        =&gt; function () { return new Aura\View\Helper\Form\Select; },
'textarea'      =&gt; function () { return new Aura\View\Helper\Form\Textarea; },
</code></pre>

<p>]);</p>

<p>$field = $helper->get(&lsquo;field&rsquo;);
function showFieldErrors($form, $name) {</p>

<pre><code>$errors = $form-&gt;getMessages($name);
$str = '';
if ($errors) {
    $str .= '&lt;ul&gt;';
    foreach ($errors as $error) {
        $str .= '&lt;li&gt;' . $error . '&lt;/li&gt;';
    }
    $str .= '&lt;/ul&gt;';
}
return $str;
</code></pre>

<p>}
?>
<html>
<head></p>

<pre><code>&lt;title&gt;Aura Form, to make it standalone&lt;/title&gt;
</code></pre>

<p></head>
<body></p>

<pre><code>&lt;form method="post" action="" enctype="multipart/form-data" &gt;
    &lt;table cellpadding="0" cellspacing="0"&gt;
        &lt;tr&gt;
            &lt;td&gt;Name : &lt;/td&gt;
            &lt;td&gt;
            &lt;?php
                echo $field($form-&gt;get('name'));
                echo showFieldErrors($form, 'name');
            ?&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Email : &lt;/td&gt;
            &lt;td&gt;
            &lt;?php
                echo $field($form-&gt;get('email'));
                echo showFieldErrors($form, 'email');
            ?&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Url : &lt;/td&gt;
            &lt;td&gt;
            &lt;?php
                echo $field($form-&gt;get('url'));
                echo showFieldErrors($form, 'url');
            ?&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Message : &lt;/td&gt;
            &lt;td&gt;
            &lt;?php
                echo $field($form-&gt;get('message'));
                echo showFieldErrors($form, 'message');
            ?&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td colspan="2"&gt;
            &lt;?php 
            echo $field($form-&gt;get('submit'));
            ?&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/form&gt;
</code></pre>

<p></body>
</html>
```</p>

<p>That&rsquo;s it. Pretty clear I guess. Still having trouble?
The whole code lies in the <a href="https://github.com/harikt/phpform/tree/minimalview">minimalview</a> branch of the <a href="https://github.com/harikt/phpform">phpform</a>.</p>
]]></content>
  </entry>
  
</feed>
